# Lambda의 중요성

## AWS Lambda의 장점

AWS 람다는 각종 AWS 서비스와 연동하기 쉬운 구조를 가지고 있고, 서버에서 프로토타입 코드를 작성해서 각종 서비스를 연동해서 코드의 실행을 테스트하기 편하다.

SAM과 같은 기능을 통해서 로컬 환경에서 람다의 코드를 실행하고 테스트를 할 수 있다.

## AWS 서비스의 문제

AWS의 각종 다른 서비스들은 로컬에서 테스트를 할 수 없고, AWS 환경에서 동작을 수행할 수 밖에 없다는 문제가 있다. 반면에 AWS Lambda는 로컬 환경에서의 테스트를 수행할 수 있다.

AWS 서비스의 다른 서비스들을 로컬 환경에서 테스트를 하기 위해서는 [localstack](https://github.com/localstack/localstack)이라는 테스트 환경을 구성하여 로컬에서 AWS 서비스들을 테스트 하는 환경을 만들던가, 아니면 CDK로 시스템을 구성하여, AWS에 빌드하여 테스트를 하는 방식을 만들어 코드를 모킹하는 과정이 필요하다.

로컬스텍은 일부 기능은 무료이지만 유료 서비스로 제공되는 기능들이 있으며, AWS CDK는 AWS 환경에서 직접 빌드하는 것이기 구성이 까다로울 수 있다. 이들을 사용하는 방법은 유용한 방법이지만, 인프라 전문가가 아닌 애플리케이션 개발자가 이를 구성하는 것은 조금 까다롭고 어려울 수 있다.

## AWS 서비스를 Lambda 경유로 사용하기

AWS 각종 서비스를 람다를 통해서 사용하고, 직접 애플리케이션에서 각종 다른 서비스로 직접 연결하지 않는 방법이 추천되는 것은, 람다는 로컬에서 테스트할 수 있는 기능을 제공하기 때문에, 람다 코드에 각종 다른 서비스를 연결하는 코드의 동작을 모킹하는 코드를 작성하여 로컬 환경에서 AWS애 연결하는 각존 기능들을 테스트 할 수 있기 때문이다. 

AWS의 다른 서비스를 직접 사용하게 되면, 테스트 코드를 사용하기 보다는 테스트용 서버에 디플로이해서 동작을 확인해야 하고, 코드의 수정과 동작 화인의 주기가 길어지기 때문에 개발 과정이 지루하고 어렵고 험난할 수 있다는 단점이 있다.

람다를 사용하여 람다를 통해서 사용되는 각종 AWS 서비스들은 프로토타입으로 코드를 작성한 후, 이를 모킹하는 코드를 만들어 동작을 테스트하게 되면, AWS 서비스의 코드들의 사양은 잘 변하지 않기 때문에 한 번 만들어 둔 모킹 코드를 오래 사용할 수 있다. 한 번 만들어진 목(mock)을 사용해서 비즈니스 로직이 변경이 되더라도 로컬 환경에서 mock을 사용한 테스트가 가능하기 때문에 로직의 변경과 확인이 수월하다는 장점이 있다.

## 콜드 스타트 문제

람다의 문제는 인터프리터 언어의 경우 런타임을 준비하기 위한 콜드 스타트로 인해서 지연이 일어날 수 있다는 점이다.

람다는 컨테이터 환경에서 동작하기 때문에, 컨테이너가 생성되지 않으면 컨테이너를 생성해야 하므로 컨테이너 생성 시간이 걸릴 수 있다.

하나의 컨테이너는 하나의 람다 코드를 실행한다. 만약 동시에 람다 호출이 여러번 호출된다면, 기존의 컨테이너를 재사용할 수 없기 때문에 컨테이너를 생성해야 하므로 콜드 스타트 시간이 걸린다.

람다 런타임의 컨테이너는 사용후 컨테이너를 종료하기까지 몇 분의 시간을 갖는다. 이 시간이 지난다면, 요청을 처리할 수 있는 기존 컨테이너가 없으므로 컨테이너를 새로 생성해야 해서 콜드 스타트 시간이 발생한다.

람다는 대량의 리퀘스트를 동시에 처리할 수 있기 때문에 리퀘스트가 많다고 해서 다음 처리가 대기하지는 않지만, 컨테이너를 계속 생성해야 하므로 하나의 처리에 걸리는 시간(리퀘스트에서 리스폰스까지의)이 늘어날 수 있다.

### 람다로 AWS 서비스 경유하는 한계점

람다로 AWS의 모든 서비스를 경유하게 하여, 람다를 통해서 AWS의 각종 서비스 코드를 모킹하여 개발한다는 발상은 메인테넌스 측면에서 좋은 전략이지만, 속도가 중요한 서비스의 경우, 람다의 콜드 스타트 지연으로 인해서 처리 속도가 늘어날 수 있기 때문에 디비, 레디스 등의 스토리지 접근 등과 같은 애플리케이션에서 속도적인 측면을 구성하는 AWS 서비스는 람다를 경유하는 쪽은 좋지많다. 오히려 이런 애플리케이션의 기반을 이루는 쪽 서비스는 로컬 환경에서 테스트할 수 있는 환경을 제공하기 때문에 굳이 람다를 사용할 필요도 없다.

## 다른 전략

AWS 서비스를 람다를 경유하는 방법을 사용하는 대신 사용해 볼 수 있는 다른 전략은 로컬스텍, CDK 등이 있다.

### 로컬스텍

### CDK

